// This is your Prisma schema file
datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/client"
}

model Team {
  id          String      @id @default(cuid())
  name        String // e.g., Mechanical Team
  description String? // NEW: "Handles all mechanical repairs..."
  technicians User[]
  equipment   Equipment[]
  requests    Request[]
}

model User {
  id       String    @id @default(cuid())
  name     String
  role     String // e.g., Admin, Technician
  jobTitle String? // NEW: "Senior Technician", "Apprentice"
  avatar   String? // NEW: Optional URL for profile picture
  teamId   String?
  team     Team?     @relation(fields: [teamId], references: [id])
  requests Request[]
}

model Equipment {
  id           String    @id @default(cuid())
  name         String
  serialNumber String    @unique
  department   String
  location     String
  status       String    @default("Active") // Active or Scrapped
  teamId       String
  team         Team      @relation(fields: [teamId], references: [id])
  requests     Request[]
}

model Request {
  id             String    @id @default(cuid())
  subject        String
  type           String // Corrective or Preventive
  status         String    @default("New") // New, In Progress, Repaired, Scrap
  priority       String    @default("Medium")
  description    String?
  scheduledDate  DateTime?
  estimatedHours Float?    @default(0) // NEW FIELD
  hoursSpent     Float?    @default(0)
  equipmentId    String
  equipment      Equipment @relation(fields: [equipmentId], references: [id])
  teamId         String
  team           Team      @relation(fields: [teamId], references: [id])
  technicianId   String?
  technician     User?     @relation(fields: [technicianId], references: [id])
  createdAt      DateTime  @default(now())
}
